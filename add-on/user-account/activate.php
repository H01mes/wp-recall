<?phpglobal $wpdb;if(!defined('RMAG_PREF')) define('RMAG_PREF', $wpdb->prefix."rmag_");require_once(ABSPATH . 'wp-admin/includes/upgrade.php');$table7 = RMAG_PREF ."users_balance";if($wpdb->get_var("show tables like '". RMAG_PREF ."user_count'") == RMAG_PREF ."user_count") {    //удаляем все данные с нулевыми значениями    $wpdb->query("DELETE FROM ". RMAG_PREF ."user_count WHERE count='0'");    //переименовываем таблицу `_user_count`    $wpdb->query("ALTER TABLE ". RMAG_PREF ."user_count RENAME $table7");    //удаляем столбец `ID`    $wpdb->query("ALTER TABLE $table7 DROP COLUMN ID");    //переименовываем столбец `user` и назначаем его уникальным ключом    $wpdb->query("ALTER TABLE $table7 CHANGE user user_id INT( 20 ) NOT NULL");    $wpdb->query("ALTER TABLE $table7 ADD UNIQUE KEY (user_id)");    //переименовываем столбец `count` и назначаем его уникальным ключом    $wpdb->query("ALTER TABLE $table7 CHANGE count user_balance VARCHAR( 20 ) NOT NULL");}else{        if($wpdb->get_var("show tables like '". $table7 . "'") != $table7) {           $wpdb->query("CREATE TABLE IF NOT EXISTS `". $table7 ."` (          user_id INT(20) NOT NULL,          user_balance VARCHAR (20) NOT NULL,          UNIQUE KEY user_id (user_id)        ) DEFAULT CHARSET=utf8;");    }    }    $table9 = RMAG_PREF ."pay_results";if($wpdb->get_var("show tables like '". $table9 . "'") != $table9) {       $wpdb->query("CREATE TABLE IF NOT EXISTS `". $table9 . "` (      ID bigint (20) NOT NULL AUTO_INCREMENT,      inv_id INT(20) NOT NULL,      user INT(20) NOT NULL,      count INT(20) NOT NULL,      time_action DATETIME NOT NULL,      UNIQUE KEY id (id)    ) DEFAULT CHARSET=utf8;");}